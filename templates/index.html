<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TC Bridge Controller</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-network-wired"></i> TC Bridge Controller</h3>
                </div>
                
                <!-- Bridge Status -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle"></i> Bridge Status</h5>
                    </div>
                    <div class="card-body">
                        <div id="bridge-status">
                            <div class="status-indicator inactive">
                                <span class="status-dot"></span>
                                <span class="status-text">Inactive</span>
                            </div>
                            <div id="bridge-details" class="mt-2" style="display: none;">
                                <small class="text-muted">
                                    <div>IP: <span id="bridge-ip">-</span></div>
                                    <div>Interfaces: <span id="bridge-interfaces">-</span></div>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h5><i class="fas fa-bolt"></i> Quick Actions</h5>
                    </div>
                    <div class="card-body">
                        <button id="create-bridge-btn" class="btn btn-success btn-sm w-100 mb-2">
                            <i class="fas fa-plus"></i> Create Bridge
                        </button>
                        <button id="destroy-bridge-btn" class="btn btn-danger btn-sm w-100 mb-2">
                            <i class="fas fa-trash"></i> Destroy Bridge
                        </button>
                        <button id="clear-tc-btn" class="btn btn-warning btn-sm w-100">
                            <i class="fas fa-eraser"></i> Clear TC Rules
                        </button>
                    </div>
                </div>

                <!-- Interface Selection -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h5><i class="fas fa-ethernet"></i> Interfaces</h5>
                    </div>
                    <div class="card-body">
                        <div id="interface-list">
                            <div class="text-muted">Loading interfaces...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 main-content">
                <div class="row">
                    <!-- Traffic Control Panel -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h4><i class="fas fa-sliders-h"></i> Traffic Control</h4>
                            </div>
                            <div class="card-body">
                                <!-- Interface Selection Tabs -->
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        <i class="fas fa-ethernet"></i> Select Interfaces to Apply TC Rules:
                                    </label>
                                    <div id="interface-tabs" class="btn-group" role="group">
                                        <!-- Interface tabs will be populated here -->
                                    </div>
                                </div>
                                
                                <form id="tc-form">
                                    <div class="row">
                                        <!-- Bandwidth Control -->
                                        <div class="col-md-6 mb-3">
                                            <label for="bandwidth" class="form-label">
                                                <i class="fas fa-tachometer-alt"></i> Bandwidth Limit (Mbps)
                                            </label>
                                            <input type="number" class="form-control" id="bandwidth" 
                                                   placeholder="e.g., 100" min="1" max="10000">
                                            <div class="form-text">Leave empty for no limit <span class="text-muted">(default: unlimited)</span></div>
                                        </div>

                                        <!-- Delay Control -->
                                        <div class="col-md-6 mb-3">
                                            <label for="delay" class="form-label">
                                                <i class="fas fa-clock"></i> Delay (ms)
                                            </label>
                                            <input type="number" class="form-control" id="delay" 
                                                   placeholder="e.g., 50" min="0" max="10000">
                                            <div class="form-text">Base delay in milliseconds <span class="text-muted">(default: 0ms)</span></div>
                                        </div>

                                        <!-- Jitter Control -->
                                        <div class="col-md-6 mb-3">
                                            <label for="jitter" class="form-label">
                                                <i class="fas fa-random"></i> Jitter (ms)
                                            </label>
                                            <input type="number" class="form-control" id="jitter" 
                                                   placeholder="e.g., 10" min="0" max="1000">
                                            <div class="form-text">Delay variation <span class="text-muted">(default: 0ms)</span></div>
                                        </div>

                                        <!-- Packet Loss -->
                                        <div class="col-md-6 mb-3">
                                            <label for="packet-loss" class="form-label">
                                                <i class="fas fa-exclamation-triangle"></i> Packet Loss (%)
                                            </label>
                                            <input type="number" class="form-control" id="packet-loss" 
                                                   placeholder="e.g., 5" min="0" max="100" step="0.1">
                                            <div class="form-text">Percentage of packets to drop <span class="text-muted">(default: 0%)</span></div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-play"></i> Apply TC Rules
                                            </button>
                                            <button type="button" id="reset-form" class="btn btn-secondary ms-2">
                                                <i class="fas fa-eraser"></i> Clear
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Network Statistics -->
                    <div class="col-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <h4><i class="fas fa-chart-line"></i> Network Statistics</h4>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <label for="interface-selector" class="form-label me-2 mb-0">
                                            <i class="fas fa-ethernet"></i> Interface:
                                        </label>
                                        <select id="interface-selector" class="form-select form-select-sm" style="width: auto;">
                                            <option value="">Select interface...</option>
                                        </select>
                                    </div>
                                    <small class="text-muted">
                                        <i class="fas fa-sync-alt fa-spin"></i> Updating every second
                                    </small>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Interface Status -->
                                <div class="row mb-3" id="interface-status" style="display: none;">
                                    <div class="col-12">
                                        <div class="alert alert-info d-flex align-items-center">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <span id="interface-status-text">Interface status will appear here</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- RX Statistics -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="stat-card">
                                            <div class="stat-icon">
                                                <i class="fas fa-download"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="rx-bytes">0 B/s</div>
                                                <div class="stat-label">Incoming Data Rate</div>
                                                <div class="stat-detail" id="rx-total">Total: 0 B</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="stat-card packet-stat">
                                            <div class="stat-icon packet-incoming">
                                                <i class="fas fa-arrow-down"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="rx-packets">0 pps</div>
                                                <div class="stat-label">Incoming Packets</div>
                                                <div class="stat-detail" id="rx-packets-total">Total: 0</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- TX Statistics -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="stat-card">
                                            <div class="stat-icon">
                                                <i class="fas fa-upload"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="tx-bytes">0 B/s</div>
                                                <div class="stat-label">Outgoing Data Rate</div>
                                                <div class="stat-detail" id="tx-total">Total: 0 B</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="stat-card packet-stat">
                                            <div class="stat-icon packet-outgoing">
                                                <i class="fas fa-arrow-up"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="tx-packets">0 pps</div>
                                                <div class="stat-label">Outgoing Packets</div>
                                                <div class="stat-detail" id="tx-packets-total">Total: 0</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Total Statistics -->
                                <div class="row mb-4 total-stats-row">
                                    <div class="col-md-4">
                                        <div class="stat-card packet-stat packet-total">
                                            <div class="stat-icon packet-total-icon">
                                                <i class="fas fa-download"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="total-bytes">0 B/s</div>
                                                <div class="stat-label">Total Data Rate</div>
                                                <div class="stat-detail" id="total-bytes-total">Total: 0 B</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="stat-card packet-stat packet-total">
                                            <div class="stat-icon packet-total-icon">
                                                <i class="fas fa-exchange-alt"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="total-packets">0 pps</div>
                                                <div class="stat-label">Total Packets</div>
                                                <div class="stat-detail" id="total-packets-total">Total: 0</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="stat-card packet-stat packet-error">
                                            <div class="stat-icon packet-error-icon">
                                                <i class="fas fa-exclamation-triangle"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="error-rate">0%</div>
                                                <div class="stat-label">Error Rate</div>
                                                <div class="stat-detail" id="error-total">Total: 0 errors</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Log Output -->
                    <div class="col-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <h4><i class="fas fa-terminal"></i> Log Output</h4>
                                <button id="clear-log" class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-trash"></i> Clear
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="log-output" class="log-container">
                                    <div class="log-entry info">
                                        <span class="log-time">[<span id="current-time"></span>]</span>
                                        <span class="log-message">TC Bridge Controller started</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Interface Selection -->
    <div class="modal fade" id="interface-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Select Interfaces for Bridge</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="modal-interface-list">
                        <!-- Interfaces will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirm-bridge-creation">Create Bridge</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html> 